apiVersion: v1
kind: Pod
metadata:
  annotations:
    bind-mount-options: /etc/nginx/conf.d:Z
  labels:
    app: nginx
  name: nginx
spec:
  containers:
    - name: nginx
      image: quay.io/testing-farm/nginx:1517991776
      args:
        - nginx
        - -g
        - daemon off;
      volumeMounts:
        - name: nginx
          mountPath: /etc/nginx/conf.d/
        - name: artifacts
          mountPath: /var/artifacts
      env:
        - name: DOMAINS
          value: "dev-{{ ansible_env.USER }}.testing-farm.io,api.dev-{{ ansible_env.USER }}.testing-farm.io,internal.api.dev-{{ ansible_env.USER }}.testing-farm.io,artifacts.dev-{{ ansible_env.USER }}.testing-farm.io,nomad.dev-{{ ansible_env.USER }}.testing-farm.io,tmt.dev-{{ ansible_env.USER }}.testing-farm.io,ui-backend.dev-{{ ansible_env.USER }}.testing-farm.io"
  hostNetwork: true
  volumes:
    - name: nginx
      hostPath:
        path: /etc/nginx/conf.d
        type: Directory
    - name: artifacts
      hostPath:
        path: /var/artifacts
        type: Directory
